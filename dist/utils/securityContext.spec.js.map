{"version":3,"sources":["../../src/utils/securityContext.spec.js"],"names":[],"mappings":";;;;;;;;;;;;;;AAKA,QAAQ,CAAC,mBAAmB,EAAE,YAAW;;AAExC,KAAI,OAAO,CAAC;;AAEZ,WAAU,CAAC,YAAW;AACrB,SAAO,GAAG,8BAAoB,EAAC,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAC,CAAC,CAAC;;AAE5D,SAAO,CAAC,KAAK,GAAG,WAXT,aAAa,EAWe,CAAC;AACpC,SAAO,CAAC,KAAK,CAAC,GAAG,CAAC,mBAAmB,EAAE,YAAW;AACjD,UAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,MAAM,CAAC;GAChD,CAAC,CAAC;AACH,SAAO,CAAC,KAAK,CAAC,GAAG,CAAC,kBAAkB,EAAE,YAAW;AAChD,UAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,KAAK,CAAC;GAC/C,CAAC,CAAC;AACH,SAAO,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,YAAW;AACtC,SAAM,IAAI,gBAAM,eAAe,CAAC,KAAK,CAAC,CAAC;GACvC,CAAC,CAAC;EACH,CAAC,CAAC;;AAEH,GAAE,CAAC,cAAc,EAAE,YAAW;AAC7B,SAAO,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,CAC5C,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC;EACxB,CAAC,CAAC;;AAEH,GAAE,CAAC,aAAa,EAAE,YAAW;AAC5B,SAAO,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC,CAC7C,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,QAAQ,CAAC;EAC5B,CAAC,CAAC;;AAEH,GAAE,CAAC,wBAAwB,EAAE,YAAW;AACvC,SAAO,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,CACxC,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,QAAQ,CAAC;EAC5B,CAAC,CAAC;;AAEH,GAAE,CAAC,2BAA2B,EAAE,YAAW;AAC1C,SAAO,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAClC,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,QAAQ,CAAC;EAC5B,CAAC,CAAC;CACH,CAAC,CAAC","file":"securityContext.spec.js","sourcesContent":["import SecurityContext from './securityContext';\nimport { SecurityRoles } from './Roles';\n\nimport error from './error';\n\ndescribe('[SecurityContext]', function() {\n\n\tvar context;\n\n\tbeforeEach(function() {\n\t\tcontext = new SecurityContext({role: 'god', gender: 'boy'});\n\n\t\tcontext.roles = new SecurityRoles();\n\t\tcontext.roles.use('view girl content', function() {\n\t\t\treturn this.user && this.user.gender === 'girl';\n\t\t});\n\t\tcontext.roles.use('view boy content', function() {\n\t\t\treturn this.user && this.user.gender === 'boy';\n\t\t});\n\t\tcontext.roles.use('reject', function() {\n\t\t\tthrow new error.BadRequestError('bla');\n\t\t});\n\t});\n\n\tit('should grant', function() {\n\t\treturn expect(context.can('view boy content'))\n\t\t\t.to.eventually.be.true;\n\t});\n\n\tit('should deny', function() {\n\t\treturn expect(context.can('view girl content'))\n\t\t\t.to.eventually.be.rejected;\n\t});\n\n\tit('should deny by default', function() {\n\t\treturn expect(context.can('administrate'))\n\t\t\t.to.eventually.be.rejected;\n\t});\n\n\tit('should forward rejections', function() {\n\t\treturn expect(context.can('reject'))\n\t\t\t.to.eventually.be.rejected;\n\t});\n});\n"]}